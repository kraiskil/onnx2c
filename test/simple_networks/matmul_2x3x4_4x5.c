// Generated by test/simple_networks/matmul.py
// Do not edit manually.

float a[2][3][4] = {{{0.8391891 , 0.23774183, 0.50238943, 0.9425836 },
  {0.6339977 , 0.8672894 , 0.9402097 , 0.75076485},
  {0.69957507, 0.96796554, 0.9944008 , 0.45182168}},

 {{0.07086978, 0.29279402, 0.1523547 , 0.41748637},
  {0.13128933, 0.6041178 , 0.38280806, 0.89538586},
  {0.96779466, 0.5468849 , 0.27482358, 0.59223044}}};
float b[4][5] = {{0.8967612 , 0.40673333, 0.55207825, 0.27165276, 0.45544416},
 {0.40171355, 0.24841346, 0.5058664 , 0.31038082, 0.37303486},
 {0.5249705 , 0.75059503, 0.33350748, 0.92415875, 0.8623186 },
 {0.0486903 , 0.25364253, 0.44613552, 0.10462789, 0.348476  }};
float y[2][3][5];
float expected[2][3][5] = {{{1.1576905 , 1.0165548 , 1.1716343 , 0.86466664, 1.2325772 },
  {1.4470836 , 1.369457  , 1.4372587 , 1.3888711 , 1.6846634 },
  {1.560227  , 1.3859897 , 1.4090953 , 1.4567368 , 1.6946416 }},

 {{0.28148186, 0.32180807, 0.42430723, 0.29461026, 0.41836187},
  {0.604977  , 0.7179125 , 0.90521765, 0.67062944, 0.92727494},
  {1.2606819 , 0.88598394, 1.1668198 , 0.74859107, 1.0881472 }}};

#include <stdio.h>
#include <math.h>

extern void entry(const float A[2][3][4], const float B[4][5], float Y[2][3][5]);

int main() {
    entry(a, b, y);
    
    float* y_flat = (float*)y;
    float* expected_flat = (float*)expected;
    for (int i = 0; i < 30; i++) {
        if (fabs(y_flat[i] - expected_flat[i]) > 1e-5 || true) {
            printf("mismatch at %d: got %f, expected %f\n", i, y_flat[i], expected_flat[i]);
            return 1;
        }
    }

    return 0;
}
